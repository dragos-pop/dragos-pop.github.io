<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>FX Ingestion Pipeline</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
		<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<div class="inner">
					<a href="index.html" class="image avatar"><img src="images/avatar1.jpg" alt="" /></a>
					<h1><strong>Dragos Pop</strong><br />
 						Data Science & Engineering</h1>
				</div>
			</header>


		<!-- Main -->
			<div id="main">
				<!-- One -->
					<section id="one">
						<header class="major">
							<h1>Exchange Rates Ingestion Pipeline</h1>
						</header>

						<h3>Jan 2024 ~ Flo Energy<br /><br /></h3>
						<p align="justify"><b>Length: </b> &nbsp; 1mo (at 0.5 FTE)<br /><br />

							<b>Programming language: </b> &nbsp; Python (os, datetime, pytz, snowflake-connector-python, Pandas,
							urllib3, Dagster)
							<br /><br />

							<b>Data: </b> &nbsp; Daily SGD exchange rates provided by the Monetary Authority of Singapore
							(MAS) <br /><br />

							<b>Problem description: </b><br />
							Orchestrate a pipeline that retrieves the latest exchange rates through an API, loads them
							into Snowflake via Amazon S3, and then materializes the downstream dbt models<br /><br />

							<b>Approach & Results: </b><br />
							In the image below, one can observe the architecture of the ingestion pipeline. First, a Python
							connector queries the raw Snowflake table for the last date with an exchange rate. Then, this
							date is used together with the code execution date to create the date range for which the latest
							SGD exchange rates will be retrieved using the MAS API. After the rates are fetched in a
							Pandas dataframe, they are exported as a .csv file to the Amazon S3 bucket that serves as a
							data lake and later copied into the raw Snowflake table. Finally, the dbt models downstream
							are materialized.<br /><br />

							Taking into account a potential erroneous API response, a retry policy was implemented to
							repeat a failing operation up to three times, with a delay of ten minutes between the runs.
							Furthermore, each pipeline step was programmed into a Dagster Software-defined asset and
							linked in a Dagster job. This job was scheduled to run every working day shortly after the
							exchange rates are published by MAS. Therefore, the latest exchange rates are automatically
							retrieved and ingested into the data warehouse with minimum human supervision.

							<br /><br />
							<img src="images/Fig47.jpg" alt="FX Rates Ingestion Diagram" width="840" height="70">
							<br />

						</p>
						<ul class="actions">
							<li><a href="Text-to-Event.html" class="button">Previous project</a>
							<a href="Selective CL Deployment.html" class="button">Next project</a></li>
						</ul>
						<ul class="actions">
							<li><a href="index.html" class="button">Home</a></li>
						</ul>
					</section>

				<!-- Three -->
					<section id="three">
							<div class="col-4 col-12-small">
								<ul class="labeled-icons">
									<li>
										<h3 class="icon solid fa-home"><span class="label">Address</span></h3>
										Amsterdam, the Netherlands<br />
									</li>
								</ul>
							</div>
					</section>

			</div>

		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<ul class="icons">
						<li><a href="https://www.linkedin.com/in/dragos-pop/" target="_blank" class="icon brands alt fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
						<li><a href="https://github.com/dragos-pop" target="_blank" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
						<li><a href="https://www.kaggle.com/dragospop" target="_blank" class="icon brands alt fa-kaggle"><span class="label">Kaggle</span></a></li>
						<li><a href="https://medium.com/@dragos-pop"  target="_blank" class="icon brands alt fa-medium"><span class="label">Medium</span></a></li>
						<li><a href="https://wandb.ai/d-a-pop" target="_blank"><span class="label">W&B</span></a></li>
					</ul>
					<ul class="copyright">
						<li>&copy; Dragos Pop</li>
					</ul>
				</div>
			</footer>


		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
